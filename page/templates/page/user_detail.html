{% extends 'base.html' %}
{% load static %}

{% block js %}
<script src="{% static 'js/search_student_name.js' %}"> </script>
{% endblock %}

{% block content %}


<div class="container-fluid">
	
	{% if user.is_authenticated %}
		<div class="row">
			<h1> Bonjour {{user.first_name}} !</h1>
		</div>
		<!--  Section propriétaire -->
		<div class="row border mt-5">
		
			<div class="row mt-2">
				<h4> Actions dans lesquelles vous avez été identifié comme propriétaire</h4>
			</div>
			
			<div class="row mb-3">
				{% if action_resp %}
				
					<div class="accordion" id="accordionResposabilite">
						{% for x in action_resp %}
							<div class="accordion-item mb-2">
								<h2 class="accordion-header" id="heading_{{forloop.counter}}">
									<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_{{forloop.counter}}" aria-expanded="true" aria-controls="collapse_{{forloop.counter}}">
										dossier: {{x.problematique.eleve.nom}} {{x.problematique.eleve.prenom}} Gr. {{x.problematique.eleve.groupe_repere}} | {{x.description}} | Attitré par: {{x.createur}}
									</button>
								</h2>
								<div id="collapse_{{forloop.counter}}" class="accordion-collapse collapse show" aria-labelledby="heading_{{forloop.counter}}" data-bs-parent="#accordionResposabilite">
									<div class="accordion-body">
										Pour la problematique: {{x.problematique.nom}}<br>
										status 
										<select class="form-select select-action-status">
											{% for option in statusaction %}
												{% if option.nom == x.status %}
													<option selected value="{{option.id}}">{{option.nom}}</option>
												{% else %}
													<option value="{{option.id}}">{{option.nom}}</option>
												{% endif %}
											{% endfor %}
										</select>
									</div>
								</div>
							</div>
						{% endfor %}
					</div>
				{% else %}
					<p>Aucune action !</p>
				{% endif %}
			</div>
			
		</div>
		
		
		<div class="row border mt-5">
		
			<div class="row mt-2">
				<h4> Actions que vous avez attribuées</h4>
			</div>
			
			<div class="row mb-3">
				{% if action_createur %}
					<div class="accordion" id="accordionAttribution">
						{% for x in action_createur %}
							<div class="accordion-item mb-2">
								<h2 class="accordion-header" id="heading{{forloop.counter}}">
									<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{forloop.counter}}" aria-expanded="true" aria-controls="collapse{{forloop.counter}}">
										dossier: {{x.problematique.eleve.nom}} {{x.problematique.eleve.prenom}} Gr. {{x.problematique.eleve.grouperepere}} | {{x.description}} | Attitré à: {{x.responsable}}
									</button>
								</h2>
								<div id="collapse{{forloop.counter}}" class="accordion-collapse collapse show" aria-labelledby="heading{{forloop.counter}}" data-bs-parent="#accordionAttribution">
									<div class="accordion-body">
										Pour la problematique: {{x.problematique.nom}}<br>
										status: {{x.status}}
									</div>
								</div>
							</div>
						{% endfor %}
					</div>
				{% else %}
					<p>Aucune action !</p>
				{% endif %}
			</div>
		</div>
		
		
		
		
		
	{% else %}
		Not authenticated
	{% endif %}
	
</div>

{% endblock %}